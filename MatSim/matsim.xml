<xmodel version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation='http://flame.ac.uk/schema/xmml_v2.xsd'>

  <name>MatSim</name>
  <version>01</version>

  <!-- FLAME Environment -->
  <environment>
    <functionFiles>
      <file>functions.c</file>
    </functionFiles>
  </environment>

  <!-- FLAME agents -->
  <agents>
    <xagent>
      <name>car</name>
      <memory>
        <variable><type>int</type><name>c_id</name></variable>
        <variable><type>int</type><name>current_place</name></variable>
        <variable><type>int</type><name>final_dest</name></variable>
        <variable><type>int</type><name>path_found</name></variable>
        <variable><type>int_array</type><name>path</name></variable>
      </memory>
      <functions>
        <function>
          <name>write_cars</name>
          <currentState>0</currentState>
          <nextState>4</nextState>
          <outputs>
            <output><messageName>cars</messageName></output>
          </outputs>
        </function>
        <function>
          <name>find_path</name>
          <currentState>4</currentState>
          <nextState>5</nextState>
          <inputs>
            <input><messageName>places</messageName></input>
          </inputs>
        </function>
        <function>
          <name>move</name>
          <currentState>5</currentState>
          <nextState>6</nextState>
          <inputs>
            <input><messageName>places</messageName></input>
          </inputs>
        </function>
        <function>
          <name>arrived</name>
          <currentState>6</currentState>
          <nextState>7</nextState>
        </function>
      </functions>
    </xagent>
    <xagent>
      <name>place</name>
      <memory>
        <variable><type>int</type><name>p_id</name></variable>
        <variable><type>int</type><name>num_cars</name></variable>
        <variable><type>int</type><name>matrix_created</name></variable>
        <variable><type>int</type><name>destinations[200]</name></variable>
      </memory>
      <functions>
        <function>
          <name>get_cars</name>
          <currentState>1</currentState>
          <nextState>2</nextState>
          <inputs>
            <input><messageName>cars</messageName></input>
          </inputs>
        </function>
        <function>
          <name>write_places</name>
          <currentState>2</currentState>
          <nextState>3</nextState>
          <outputs>
            <output><messageName>places</messageName></output>
          </outputs>
        </function>
        <function>
          <name>create_matrix</name>
          <currentState>3</currentState>
          <nextState>4</nextState>
        </function>
      </functions>
    </xagent>
  </agents>

  <!-- FLAME messages -->
  <messages>
    <message>
      <name>cars</name>
      <variables>
        <variable><type>int</type><name>c_id</name></variable>
        <variable><type>int</type><name>current_place</name></variable>
        <variable><type>int</type><name>final_dest</name></variable>
      </variables>
    </message>
    <message>
      <name>places</name>
      <variables>
        <variable><type>int</type><name>p_id</name></variable>
        <variable><type>int</type><name>num_cars</name></variable>
      </variables>
    </message>
  </messages>
</xmodel>
