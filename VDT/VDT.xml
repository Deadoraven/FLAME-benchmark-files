<xmodel version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation='http://flame.ac.uk/schema/xmml_v2.xsd'>

  <name>VDT</name>
  <version>01</version>

  <!-- FLAME Environment -->
  <environment>
    <functionFiles>
      <file>functions.c</file>
    </functionFiles>
  </environment>

  <!-- FLAME agents -->
  <agents>
    <xagent>
      <name>supervisor</name>
      <memory>
        <variable><type>int</type><name>id</name></variable>
        <variable><type>int</type><name>phase_id</name></variable>
        <variable><type>int</type><name>total_phases</name></variable>
        <variable><type>int</type><name>fund</name></variable>
        <variable><type>int</type><name>is_hiring</name></variable>
      </memory>
      <functions>
        <function>
          <name>req_check</name>
          <currentState>1</currentState>
          <nextState>2</nextState>
          <inputs>
            <input><messageName>phases</messageName></input>
          </inputs>
        </function>
        <function>
          <name>fund_request</name>
          <currentState>2</currentState>
          <nextState>3</nextState>
          <inputs>
            <input><messageName>headquarter</messageName></input>
          </inputs>
        </function>
        <function>
          <name>hire</name>
          <currentState>3</currentState>
          <nextState>4</nextState>
          <inputs>
            <input><messageName>devs</messageName></input>
          </inputs>
        </function>
        <function>
          <name>write_supers</name>
          <currentState>4</currentState>
          <nextState>6</nextState>
          <outputs>
            <output><messageName>supers</messageName></output>
          </outputs>
        </function>
        <function>
          <name>phase_change</name>
          <currentState>6</currentState>
          <nextState>7</nextState>
          <inputs>
            <input><messageName>phases</messageName></input>
          </inputs>
        </function>
      </functions>
    </xagent>
    <xagent>
      <name>phase</name>
      <memory>
        <variable><type>int</type><name>p_id</name></variable>
        <variable><type>int</type><name>p_super_id</name></variable>
        <variable><type>int</type><name>needed_money</name></variable>
        <variable><type>int</type><name>needed_dev</name></variable>
        <variable><type>int</type><name>is_done</name></variable>
      </memory>
      <functions>
        <function>
          <name>write_phases</name>
          <currentState>0</currentState>
          <nextState>5</nextState>
          <outputs>
            <output><messageName>phases</messageName></output>
          </outputs>
        </function>
        <function>
          <name>check_end</name>
          <currentState>5</currentState>
          <nextState>7</nextState>
          <inputs>
            <input><messageName>supers</messageName></input>
          </inputs>
        </function>
      </functions>
    </xagent>
    <xagent>
      <name>developer</name>
      <memory>
        <variable><type>int</type><name>d_id</name></variable>
        <variable><type>int</type><name>d_super_id</name></variable>
        <variable><type>int</type><name>is_working</name></variable>
      </memory>
      <functions>
        <function>
          <name>write_devs</name>
          <currentState>0</currentState>
          <nextState>3</nextState>
          <outputs>
            <output><messageName>devs</messageName></output>
          </outputs>
        </function>
        <function>
          <name>hire_devs</name>
          <currentState>3</currentState>
          <nextState>4</nextState>
          <inputs>
            <input><messageName>supers</messageName></input>
          </inputs>
        </function>
      </functions>
    </xagent>
    <xagent>
      <name>headquarter</name>
      <memory>
        <variable><type>int</type><name>money</name></variable>
      </memory>
      <functions>
        <function>
          <name>write_hq</name>
          <currentState>0</currentState>
          <nextState>3</nextState>
          <outputs>
            <output><messageName>headquarter</messageName></output>
          </outputs>
        </function>
        <function>
          <name>update_money</name>
          <currentState>3</currentState>
          <nextState>7</nextState>
          <inputs>
            <input><messageName>supers</messageName></input>
          </inputs>
        </function>
      </functions>
    </xagent>
  </agents>


  <!-- FLAME messages -->
  <messages>
    <message>
      <name>supers</name>
      <variables>
        <variable><type>int</type><name>id</name></variable>
        <variable><type>int</type><name>phase_id</name></variable>
        <variable><type>int</type><name>fund</name></variable>
        <variable><type>int</type><name>is_hiring</name></variable>
      </variables>
    </message>
    <message>
      <name>phases</name>
      <variables>
        <variable><type>int</type><name>p_id</name></variable>
        <variable><type>int</type><name>p_super_id</name></variable>
        <variable><type>int</type><name>needed_money</name></variable>
        <variable><type>int</type><name>needed_dev</name></variable>
        <variable><type>int</type><name>is_done</name></variable>
      </variables>
    </message>
    <message>
      <name>devs</name>
      <variables>
        <variable><type>int</type><name>d_id</name></variable>
        <variable><type>int</type><name>d_super_id</name></variable>
        <variable><type>int</type><name>is_working</name></variable>
      </variables>
    </message>
    <message>
      <name>headquarter</name>
      <variables>
        <variable><type>int</type><name>money</name></variable>
      </variables>
    </message>
  </messages>
</xmodel>
